!function(c,l){var d=c(document),u={};l.bind("ready",function(e,t){var r=function(i,e,o,a){var s,n;"yes"!==Customify_Layout_Builder.hide_switcher&&"object"==typeof i.versions&&(s="",c.each(i.versions,function(e,t){s+='<option value="'+e+'" '+(e===a?' selected="selected" ':"")+">"+t.label+"</option>"}),s&&(n=c('<span class="customify-swicth-version button-primary"><span>'+Customify_Layout_Builder.swicth_version+'</span><select class="builder-version-change ">'+s+"</select></span>"),c(".customify--cb-actions",e.container).prepend(n)),n.on("change","select",function(){var e,t=c(this).val();u[o+a]&&u[o+a].container.hide(),void 0===u[o+t]&&(e=new("v2"===t?CustomizeBuilder_V2:CustomizeBuilder_V1)(i,o),r(i,e,o,t),u[o+t]=e),l.control(i.version_id).setting.set(t),d.trigger("customify/customizer/value_changed"),u[o+t]&&u[o+t].container.show(),n.find("option").removeAttr("selected"),n.find('option[value="'+a+'"]').attr("selected","selected")}))};_.each(Customify_Layout_Builder.builders,function(e,t){var i,o="v1";void 0!==e.version_id?o=l.control(e.version_id).params.value:e.version_id=!1,i=new("v2"===o?CustomizeBuilder_V2:CustomizeBuilder_V1)(e,t),u[t+o]=i,r(e,i,t,o)}),l.bind("pane-contents-reflowed",function(){setTimeout(function(){c("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice .footer_moved_widgets_text").length||c("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice").append('<p class="footer_moved_widgets_text">'+Customify_Layout_Builder.footer_moved_widgets_text+"</p>")},1e3)}),l.state("expandedSection").bind(function(e){c(".customify--device-panel .grid-stack-item").removeClass("item-active"),c(".customify--cb-row").removeClass("row-active"),e&&(c('.customify--cb-row[data-id="'+e.id+'"]').addClass("row-active"),c(".customify--device-panel .grid-stack-item.for-s-"+e.id).addClass("item-active"))})}),d.on("click",".focus-section",function(e){e.preventDefault();var t=c(this).attr("data-id")||"";(t=t||(t=c(this).attr("href")||"").replace("#",""))&&l.section(t)&&l.section(t).focus()}),d.on("click",".focus-control",function(e){e.preventDefault();var t=c(this).attr("data-id")||"";(t=t||(t=c(this).attr("href")||"").replace("#",""))&&l.control(t)&&l.control(t).focus()}),d.on("click",".focus-panel",function(e){e.preventDefault();var t=c(this).attr("data-id")||"";(t=t||(t=c(this).attr("href")||"").replace("#",""))&&l.panel(t)&&l.panel(t).focus()}),d.on("click",".save-template-form .save-builder-template",function(e){e.preventDefault();var t=c(this).closest(".customize-control"),i=c(".template-input-name",t),o=i.val();o&&""!==o&&c.post(ajaxurl,{action:"customify_builder_save_template",name:i.val(),id:i.attr("data-builder-id")||"",control:i.attr("data-control-id")||"",preview_data:l.get()},function(e){e.success&&(i.val(""),t.find(".list-saved-templates").prepend(e.data.li),t.find(".list-saved-templates").addClass("has-templates"))})}),d.on("click",".list-saved-templates .saved_template .remove-tpl",function(e){e.preventDefault();var t=c(this).parent(),i=c(this).closest(".customize-control"),o=c(".template-input-name",i),a=t.data("id")||"";c.post(ajaxurl,{action:"customify_builder_save_template",id:o.attr("data-builder-id")||"",remove:a},function(e){t.remove(),i.find(".list-saved-templates li.saved_template").length<=0&&i.find(".list-saved-templates").removeClass("has-templates")})});d.on("click",".list-saved-templates .saved_template .load-tpl",function(e){e.preventDefault();var t=c(this).parent(),i=c.Deferred(),o=_.clone(window.location),a=t.data("control-id")||"",s=t.data("data")||{};_.isObject(s)||(s={}),_.each(s,function(e,t){var i;l.control(t)&&(_.isEmpty(e)||l.control(t).setting.set((i=e,encodeURI(JSON.stringify(i)))))});var n=c(".wp-full-overlay");n.addClass("customize-active full-overlay-active customize-loading");var r=function(){var e;if(!(0<l.state("processing").get()))return l.state("processing").unbind(r),(e=l.requestChangesetUpdate()).done(function(){c(window).off("beforeunload.customize-confirm"),top.location.href=o.origin+o.pathname+"?autofocus[control]="+a+"&url="+encodeURIComponent(l.previewer.previewUrl.get())+"&changeset_uuid="+l.settings.changeset.uuid,i.resolve()}),e.fail(function(){n.removeClass("customize-loading"),i.reject()}),i.promise()};0===l.state("processing").get()?r():l.state("processing").bind(r)}),d.on("mouseover",".customify--cb-row .grid-stack-item:not(.no-tooltip)",function(e){var t=c(this),i=c(".customify--cb-item-remove",t).outerWidth()+c(".customify--cb-item-setting",t).outerWidth();c(".grid-stack-item-content",t).innerWidth()-50<i&&t.addClass("show-tooltip")}),d.on("mouseleave",".customify--cb-row .grid-stack-item:not(.no-tooltip)",function(e){c(this).removeClass("show-tooltip")})}(jQuery,wp.customize||null);